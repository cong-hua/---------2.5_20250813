# 支付参数配置详细指南

## 目录
1. [微信支付配置](#微信支付配置)
2. [支付宝配置](#支付宝配置)
3. [环境变量配置](#环境变量配置)
4. [测试验证](#测试验证)
5. [常见问题](#常见问题)

## 微信支付配置

### 步骤1：申请微信商户号

1. **访问微信支付官网**
   - 网址：https://pay.weixin.qq.com/
   - 点击"立即接入"

2. **选择主体类型**
   - 个人：选择"小微商户"
   - 企业：选择"普通商户"

3. **提交资料**
   - 营业执照（企业）或身份证（个人）
   - 银行账户信息
   - 联系人信息
   - 经营场所照片

4. **等待审核**
   - 通常1-7个工作日
   - 审核通过后会收到商户号

### 步骤2：获取API密钥

1. **登录微信商户平台**
   - 网址：https://pay.weixin.qq.com/
   - 使用商户号登录

2. **设置API密钥**
   - 进入"账户中心" → "API安全"
   - 点击"设置API密钥"
   - 设置32位的API密钥（建议使用随机生成）
   - **重要**：妥善保存此密钥，后续无法查看

### 步骤3：下载API证书

1. **申请API证书**
   - 在"API安全"页面点击"申请API证书"
   - 下载证书工具
   - 按提示生成证书请求文件
   - 上传后下载证书

2. **证书文件说明**
   - `apiclient_cert.pem` - 商户证书
   - `apiclient_key.pem` - 商户私钥
   - `rootca.pem` - CA证书

### 步骤4：配置产品设置

1. **开通JSAPI支付**
   - 产品中心 → JSAPI支付 → 开通

2. **开通Native支付（扫码支付）**
   - 产品中心 → Native支付 → 开通

3. **配置支付目录**
   - 产品中心 → 开发配置
   - 设置支付授权目录：`https://your-domain.com/`

## 支付宝配置

### 步骤1：创建应用

1. **登录支付宝开放平台**
   - 网址：https://open.alipay.com/
   - 使用支付宝账号登录

2. **创建应用**
   - 控制台 → 应用列表 → 创建应用
   - 选择"网页&移动应用"
   - 填写应用信息

3. **应用信息**
   - 应用名称：小红书发布插件
   - 应用简介：自动发布工具积分充值
   - 应用图标：上传应用图标

### 步骤2：配置应用

1. **添加功能**
   - 能力列表中添加：
     - "手机网站支付"
     - "电脑网站支付"
     - "当面付"（扫码支付）

2. **接口加签方式**
   - 开发设置 → 接口加签方式
   - 选择"公钥证书"或"公钥"模式
   - 推荐使用"公钥证书"模式

### 步骤3：生成密钥

1. **下载密钥生成工具**
   - 支付宝提供的RSA密钥生成工具
   - 网址：https://opendocs.alipay.com/common/02kipl

2. **生成密钥对**
   ```bash
   # 使用工具生成2048位RSA密钥对
   # 会生成：
   # - 应用私钥（用于签名）
   # - 应用公钥（上传到支付宝）
   ```

3. **上传公钥**
   - 开发设置 → 接口加签方式
   - 上传应用公钥
   - 保存支付宝公钥（用于验签）

### 步骤4：配置回调地址

1. **网关地址**
   - 沙箱环境：`https://openapi.alipaydev.com/gateway.do`
   - 正式环境：`https://openapi.alipay.com/gateway.do`

2. **授权回调地址**
   - 设置：`https://your-domain.com/payment/alipay/return`

## 环境变量配置

现在让我帮您创建配置文件：

### 步骤1：创建.env文件

